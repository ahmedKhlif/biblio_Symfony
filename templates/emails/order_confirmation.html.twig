{% extends 'emails/base.html.twig' %}

{% block subject %}Confirmation de votre commande {{ order.orderNumber }}{% endblock %}

{% block body %}
<h2>Merci pour votre commande !</h2>

<p>Bonjour {{ user.username ?: user.email }},</p>

<p>Votre commande a été confirmée avec succès. Voici les détails de votre commande :</p>

<div style="background: #f8f9fa; padding: 20px; border-radius: 8px; margin: 20px 0;">
    <h3>Commande #{{ order.orderNumber }}</h3>
    <p><strong>Date :</strong> {{ order.createdAt|date('d/m/Y H:i') }}</p>
    <p><strong>Statut :</strong> {{ order.statusLabel }}</p>
    <p><strong>Total :</strong> {{ order.formattedTotalAmount }}</p>
</div>

<h3>Articles commandés :</h3>
<table style="width: 100%; border-collapse: collapse;">
    <thead>
        <tr style="background: #f8f9fa;">
            <th style="padding: 10px; border: 1px solid #ddd; text-align: left;">Livre</th>
            <th style="padding: 10px; border: 1px solid #ddd; text-align: center;">Quantité</th>
            <th style="padding: 10px; border: 1px solid #ddd; text-align: right;">Prix</th>
            <th style="padding: 10px; border: 1px solid #ddd; text-align: right;">Total</th>
        </tr>
    </thead>
    <tbody>
        {% for item in order.orderItems %}
        <tr>
            <td style="padding: 10px; border: 1px solid #ddd;">
                <strong>{{ item.livre.titre }}</strong><br>
                <small>{{ item.livre.auteur ? item.livre.auteur.prenom ~ ' ' ~ item.livre.auteur.nom : 'Auteur inconnu' }}</small>
            </td>
            <td style="padding: 10px; border: 1px solid #ddd; text-align: center;">{{ item.quantity }}</td>
            <td style="padding: 10px; border: 1px solid #ddd; text-align: right;">{{ item.formattedUnitPrice }}</td>
            <td style="padding: 10px; border: 1px solid #ddd; text-align: right;">{{ item.formattedSubtotal }}</td>
        </tr>
        {% endfor %}
    </tbody>
    <tfoot>
        <tr style="background: #f8f9fa;">
            <th colspan="3" style="padding: 10px; border: 1px solid #ddd; text-align: right;">Total</th>
            <th style="padding: 10px; border: 1px solid #ddd; text-align: right;">{{ order.formattedTotalAmount }}</th>
        </tr>
    </tfoot>
</table>

<p>Nous vous tiendrons informé de l'évolution de votre commande par email.</p>

<p>Cordialement,<br>L'équipe Biblio</p>
{% endblock %}