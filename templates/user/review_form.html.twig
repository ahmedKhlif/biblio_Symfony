{% extends 'backendofficebase.html.twig' %}

{% block title %}Write Review - {{ livre.titre }}{% endblock %}

{% block body %}
<div class="container-fluid">
    <div class="d-sm-flex align-items-center justify-content-between mb-4">
        <div>
            <h1 class="h3 mb-0 text-gray-800">Write a Review</h1>
            <small class="text-muted">Share your thoughts about "{{ livre.titre }}"</small>
        </div>
        <a href="{{ path('app_livre_show', {'id': livre.id}) }}" class="btn btn-secondary">
            <i class="fas fa-arrow-left mr-1"></i>Back to Book
        </a>
    </div>

    <!-- Book Info Card -->
    <div class="card shadow mb-4">
        <div class="card-header py-3">
            <h6 class="m-0 font-weight-bold text-primary">
                <i class="fas fa-book mr-2"></i>Book Information
            </h6>
        </div>
        <div class="card-body">
            <div class="row">
                <div class="col-md-3">
                    {% if livre.image %}
                        <img src="{{ asset('uploads/images/' ~ livre.image) }}"
                             alt="{{ livre.titre }}"
                             class="img-fluid rounded shadow">
                    {% else %}
                        <div class="text-center">
                            <i class="fas fa-book fa-5x text-gray-300"></i>
                        </div>
                    {% endif %}
                </div>
                <div class="col-md-9">
                    <h4 class="font-weight-bold">{{ livre.titre }}</h4>
                    <p class="text-muted mb-2">
                        <i class="fas fa-user mr-1"></i>
                        {{ livre.auteur ? livre.auteur.prenom ~ ' ' ~ livre.auteur.nom : 'Auteur inconnu' }}
                    </p>
                    <p class="text-muted mb-0">
                        <i class="fas fa-tag mr-1"></i>{{ livre.categorie ? livre.categorie.designation : 'N/A' }} •
                        <i class="fas fa-calendar mr-1"></i>{{ livre.dateEdition|date('Y') }} •
                        <i class="fas fa-file-alt mr-1"></i>{{ livre.nbPages }} pages
                    </p>
                </div>
            </div>
        </div>
    </div>

    <!-- Review Form -->
    <div class="card shadow">
        <div class="card-header py-3">
            <h6 class="m-0 font-weight-bold text-primary">
                <i class="fas fa-star mr-2"></i>Your Review
            </h6>
        </div>
        <div class="card-body">
            {{ form_start(reviewForm, {'attr': {'class': 'review-form'}}) }}
                <div class="form-group mb-4">
                    <label class="font-weight-bold">Rating</label>
                    <div class="rating-stars">
                        {{ form_widget(reviewForm.rating) }}
                    </div>
                    <div class="text-muted small">Click on a star to rate this book</div>
                </div>

                <div class="form-group mb-4">
                    {{ form_label(reviewForm.comment) }}
                    {{ form_widget(reviewForm.comment, {'attr': {'class': 'form-control'}}) }}
                    {{ form_help(reviewForm.comment) }}
                </div>

                <div class="form-group">
                    <button type="submit" class="btn btn-primary btn-lg">
                        <i class="fas fa-paper-plane mr-2"></i>Submit Review
                    </button>
                    <a href="{{ path('app_livre_show', {'id': livre.id}) }}" class="btn btn-secondary btn-lg ml-2">
                        <i class="fas fa-times mr-2"></i>Cancel
                    </a>
                </div>
            {{ form_end(reviewForm) }}
        </div>
    </div>
</div>

<style>
.rating-stars {
    display: flex;
    gap: 10px;
    margin-top: 10px;
}

.rating-stars input[type="radio"] {
    display: none;
}

.rating-stars label {
    font-size: 30px;
    color: #ddd;
    cursor: pointer;
    transition: color 0.3s;
}

.rating-stars input[type="radio"]:checked ~ label,
.rating-stars input[type="radio"]:checked ~ label ~ label {
    color: #ffc107;
}

.rating-stars label:hover,
.rating-stars label:hover ~ label {
    color: #ffc107;
}
</style>

<script>
document.addEventListener('DOMContentLoaded', function() {
    const ratingInputs = document.querySelectorAll('.rating-stars input[type="radio"]');
    const ratingLabels = document.querySelectorAll('.rating-stars label');

    ratingLabels.forEach((label, index) => {
        label.addEventListener('click', function() {
            // Reset all stars
            ratingLabels.forEach(l => l.style.color = '#ddd');

            // Color selected stars
            for (let i = 0; i <= index; i++) {
                ratingLabels[i].style.color = '#ffc107';
            }
        });
    });
});
</script>
{% endblock %}